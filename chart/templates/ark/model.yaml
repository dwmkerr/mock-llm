{{- if .Values.ark.model.enabled -}}
apiVersion: ark.mckinsey.com/v1alpha1
kind: Model
metadata:
  name: {{ .Values.ark.model.name }}
  labels:
    {{- include "mock-llm.labels" . | nindent 4 }}
    {{- with .Values.ark.model.labels }}
    {{- toYaml . | nindent 4 }}
    {{- end }}
spec:
  provider: {{ .Values.ark.model.provider }}
  type: {{ .Values.ark.model.type }}
  model:
    value: {{ .Values.ark.model.model }}
  pollInterval: {{ .Values.ark.model.pollInterval }}
  config:
    {{- if eq .Values.ark.model.provider "openai" }}
    openai:
      baseUrl:
        {{- if .Values.ark.model.baseUrl }}
        value: {{ .Values.ark.model.baseUrl }}
        {{- else }}
        value: http://{{ include "mock-llm.fullname" . }}.{{ .Release.Namespace }}.svc.cluster.local:{{ .Values.service.port }}/v1
        {{- end }}
      apiKey:
        value: {{ .Values.ark.model.apiKey }}
      {{- with .Values.ark.model.headers }}
      headers:
        {{- toYaml . | nindent 8 }}
      {{- end }}
    {{- else if eq .Values.ark.model.provider "azure" }}
    azure:
      baseUrl:
        {{- if .Values.ark.model.baseUrl }}
        value: {{ .Values.ark.model.baseUrl }}
        {{- else }}
        value: http://{{ include "mock-llm.fullname" . }}.{{ .Release.Namespace }}.svc.cluster.local:{{ .Values.service.port }}
        {{- end }}
      apiKey:
        value: {{ .Values.ark.model.apiKey }}
      apiVersion:
        value: {{ .Values.ark.model.apiVersion }}
      {{- with .Values.ark.model.headers }}
      headers:
        {{- toYaml . | nindent 8 }}
      {{- end }}
    {{- else if eq .Values.ark.model.provider "bedrock" }}
    bedrock:
      baseUrl:
        {{- if .Values.ark.model.baseUrl }}
        value: {{ .Values.ark.model.baseUrl }}
        {{- else }}
        value: http://{{ include "mock-llm.fullname" . }}.{{ .Release.Namespace }}.svc.cluster.local:{{ .Values.service.port }}
        {{- end }}
      apiKey:
        value: {{ .Values.ark.model.apiKey }}
      {{- with .Values.ark.model.headers }}
      headers:
        {{- toYaml . | nindent 8 }}
      {{- end }}
    {{- end }}
{{- end }}
